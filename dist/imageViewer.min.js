!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ImageViewer=t():e.ImageViewer=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=17)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enableMultiple=t,this._handlers={}}return n(e,[{key:"on",value:function(e,t,i){(i=void 0===i?this._enableMultiple:i)?(this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push(t)):this._handlers[e]=[t]}},{key:"off",value:function(e){delete this._handlers[e]}},{key:"emit",value:function(e){for(var t=this,i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];var s=this._handlers[e]||[];s.length&&s.forEach(function(e){e.apply(t,n)})}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._locks={}}return n(e,[{key:"createLock",value:function(e){this._locks[e]=!1}},{key:"deleteLock",value:function(e){delete this._locks[e]}},{key:"getLock",value:function(e){this._locks[e]=!0}},{key:"releaseLock",value:function(e){this._locks[e]=!1}},{key:"getLockState",value:function(e){return this._locks[e]}}]),e}();t.default=new a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isNumber=function(e){return parseFloat(e)===e},t.isPlainObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOCK_NAME="STOP_SWIPE",t.ITEM_ANIMATION_CLASS="viewer-animation",t.LEFT_IMG=-1,t.CENTER_IMG=0,t.RIGHT_IMG=1},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a,s=(n=document.createElement("div").style,a="",["transform","webkitTransform","MozTransform","oTransform","msTransform"].forEach(function(e){void 0!==n[e]&&(a=e)}),a);t.query=function(e,t){return(t=t||document).querySelectorAll(e)},t.removeElement=function(e){var t=e.parentNode;t&&t.removeChild(e)},t.setTranslateStyle=function(e,t,i){e.style[s]="translate3d("+t+"px,"+i+"px,0)"},t.setScaleAndTranslateStyle=function(e,t,i,n){e.style[s]="scale3d("+t+","+t+",1) translate3d("+i+"px,"+n+"px,0)"}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var a,s=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?e:(a=0===s.indexOf("//")?s:0===s.indexOf("/")?i+s:n+s.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")})}},function(e,t,i){var n,a,s={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=n.apply(this,arguments)),a}),l=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var i=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}}(),o=null,h=0,c=[],u=i(5);function d(e,t){for(var i=0;i<e.length;i++){var n=e[i],a=s[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(w(n.parts[r],t))}else{var l=[];for(r=0;r<n.parts.length;r++)l.push(w(n.parts[r],t));s[n.id]={id:n.id,refs:1,parts:l}}}}function f(e,t){for(var i=[],n={},a=0;a<e.length;a++){var s=e[a],r=t.base?s[0]+t.base:s[0],l={css:s[1],media:s[2],sourceMap:s[3]};n[r]?n[r].parts.push(l):i.push(n[r]={id:r,parts:[l]})}return i}function v(e,t){var i=l(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),c.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=l(e.insertInto+" "+e.insertAt.before);i.insertBefore(t,a)}}function p(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function m(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),g(t,e.attrs),v(e,t),t}function g(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}function w(e,t){var i,n,a,s;if(t.transform&&e.css){if(!(s=t.transform(e.css)))return function(){};e.css=s}if(t.singleton){var r=h++;i=o||(o=m(t)),n=b.bind(null,i,r,!1),a=b.bind(null,i,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),v(e,t),t}(t),n=function(e,t,i){var n=i.css,a=i.sourceMap,s=void 0===t.convertToAbsoluteUrls&&a;(t.convertToAbsoluteUrls||s)&&(n=u(n));a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var r=new Blob([n],{type:"text/css"}),l=e.href;e.href=URL.createObjectURL(r),l&&URL.revokeObjectURL(l)}.bind(null,i,t),a=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=m(t),n=function(e,t){var i=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}.bind(null,i),a=function(){p(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=f(e,t);return d(i,t),function(e){for(var n=[],a=0;a<i.length;a++){var r=i[a];(l=s[r.id]).refs--,n.push(l)}e&&d(f(e,t),t);for(a=0;a<n.length;a++){var l;if(0===(l=n[a]).refs){for(var o=0;o<l.parts.length;o++)l.parts[o]();delete s[l.id]}}}};var y,_=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function b(e,t,i,n){var a=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=_(t,a);else{var s=document.createTextNode(a),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var a=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),s=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[i].concat(s).concat([a]).join("\n")}var r;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},a=0;a<this.length;a++){var s=this[a][0];"number"==typeof s&&(n[s]=!0)}for(a=0;a<e.length;a++){var r=e[a];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),t.push(r))}},t}},function(e,t,i){(e.exports=i(7)(!1)).push([e.i,".image-viewer{position:fixed;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden}.image-viewer .viewer-animation{transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.image-viewer .viewer{display:inline-block;position:absolute;top:50%;width:100%;text-align:center;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.image-viewer .image-header{position:absolute;top:0;left:0;width:100%;color:#fff;font-size:12px;z-index:12}.image-viewer .image-body{width:100%;height:100%;background-color:#000;z-index:10}.image-viewer .image-body .viewer-wrapper{height:100%;font-size:0}.image-viewer .image-body .panel{display:inline-block;overflow:hidden}.image-viewer .image-body .panel img{max-width:100%;max-height:100%}.image-viewer .image-body .panel span{font-size:12px;color:#fff}.image-viewer .image-footer{position:absolute;left:0;bottom:0;width:100%;color:#fff;font-size:12px;z-index:12}.image-viewer .image-animation{position:absolute;z-index:5;will-change:transform,width,height;-webkit-backface-visibility:hidden;backface-visibility:hidden}.image-viewer .image-animation img{max-width:100%;max-height:100%}.image-viewer .image-animation.hide{width:0!important;height:0!important;will-change:auto}.image-viewer .ball-clip-rotate{position:absolute;top:50%;left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:100%;z-index:11;text-align:center}.image-viewer .ball-clip-rotate>div{display:inline-block;width:26px;height:26px;border-radius:100%;border:2px solid #fff;border-bottom-color:transparent;background:0 0;-webkit-animation:ballRotate .75s 0s linear infinite;animation:ballRotate .75s 0s linear infinite}.image-viewer .ball-clip-rotate.hide{display:none}@-webkit-keyframes ballRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes ballRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},function(e,t,i){var n=i(8);"string"==typeof n&&(n=[[e.i,n,""]]);var a={sourceMap:!1,hmr:!0,transform:void 0,insertInto:void 0};i(6)(n,a);n.locals&&(e.exports=n.locals)},function(e,t){e.exports='<div class=image-viewer> <div class=image-header></div> <div class=image-body> <div class=viewer-wrapper> <div class=viewer> <div class=panel><img><span></span></div> <div class="ball-clip-rotate hide"> <div></div> </div> </div> <div class=viewer> <div class=panel><img><span></span></div> <div class="ball-clip-rotate hide"> <div></div> </div> </div> <div class=viewer> <div class=panel><img><span></span></div> <div class="ball-clip-rotate hide"> <div></div> </div> </div> </div> </div> <div class=image-footer></div> <div class="image-animation hide"><img></div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(4),s=i(3),r=h(i(1)),l=h(i(0)),o=i(2);function h(e){return e&&e.__esModule?e:{default:e}}var c=0,u=function(){},d=function(){function e(t,i,n,s,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=++c,this.src="",this.event=new l.default(!1),this.imageViewer=t,this.el=i,this.panelEl=i.firstElementChild,this.imageEl=(0,a.query)("img",this.el)[0],this.tipsEl=(0,a.query)("span",this.el)[0],this.loadingEl=(0,a.query)(".ball-clip-rotate",this.el)[0],this.imageOption=null,this.index=r,this.displayIndex=0,this.width=n,this.height=s,this.realWidth=0,this.realHeight=0,this.translateX=0,this.translateY=0,this.canScale=!1,this.scale=1,this.currentScale=1,this.translatePanelX=0,this.translatePanelY=0,this.currentPanelX=0,this.currentPanelY=0,this.allowDistanceX=0,this.allowDistanceY=0,this.needResetX=!1,this.needResetY=!1,this.SUCCESS_EVENT="LOAD_COMPLETE",this.FAIL_EVENT="LOAD_FAIL",this._bindEvent()}return n(e,[{key:"_initImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;e&&(this.scale=1,this.allowDistanceX=this.allowDistanceY=0),this.translatePanelX=0,this.translatePanelY=0,this.currentPanelX=0,this.currentPanelY=0,this.realWidth=this.panelEl.clientWidth*this.scale,this.realHeight=this.panelEl.clientHeight*this.scale,this.translateX=this.displayIndex*this.width,this.translateY=-this.el.clientHeight/2,this.needResetX=this.needResetY=!1,(0,a.setScaleAndTranslateStyle)(this.panelEl,this.scale,this.translatePanelX,this.translatePanelY),(0,a.setTranslateStyle)(this.el,this.translateX,this.translateY),t()}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.imageOption,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.displayIndex,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u,l="",o=function(e){(n.src===l||e)&&(n.canScale=!0,n.tipsEl.innerText="",n.imageEl.style.display="",n._initImage(i,r))},h=function(e){(n.src===l||e)&&(n.imageEl.style.display="none",l&&n.isActive()?(n._initImage(i),n.tipsEl.innerText="load image fail"):n.tipsEl.innerText="",r())};this.canScale=!1,this.imageOption=e,this.displayIndex=t,this.hideLoading(),s&&this.src!==this.imageOption.url?e._hasLoadLarge?l=e.url:(l=e.thumbnail)?this.isActive()&&(this.showLoading(),window.requestAnimationFrame(function(){n.loadImg(e.url,function(){n.src===e.thumbnail&&(n.hideLoading(),n.isActive()&&(n._setImageUrl(e.url),o(!0)))},function(){n.src===e.thumbnail&&(n.hideLoading(),n.isActive()&&h(!0))},function(){e._hasLoadLarge=!0})})):(l=e.url,this.imageEl.style.display="none"):l=e.thumbnail||e.url,this._setImageUrl(l),this.event.on(this.SUCCESS_EVENT,o),this.event.on(this.FAIL_EVENT,h),(0,a.setTranslateStyle)(this.el,this.displayIndex*this.width,this.translateY)}},{key:"_setImageUrl",value:function(e){this.imageEl.src=this.src=e}},{key:"loadImg",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],a=new Image;a.onload=function(){t(),n()},a.onerror=function(){i(),n()},a.src=e}},{key:"showLoading",value:function(){this.loadingEl.classList.remove("hide")}},{key:"hideLoading",value:function(){this.loadingEl.classList.add("hide")}},{key:"isActive",value:function(){return this.imageViewer._getCurrentViewer().id===this.id}},{key:"_bindEvent",value:function(){var e=this;this.imageEl.addEventListener("load",function(){e.event.emit(e.SUCCESS_EVENT)},!1),this.imageEl.addEventListener("error",function(){e.event.emit(e.FAIL_EVENT)},!1)}},{key:"_pinchStart",value:function(){this.canScale&&(this.removeAnimation(),this.panelEl.style.willChange="transform")}},{key:"_pinch",value:function(e){if(this.canScale){var t=e*this.scale+this.scale;t>.5&&t<8&&(this.currentScale=t,(0,a.setScaleAndTranslateStyle)(this.panelEl,this.currentScale,this.translatePanelX,this.translatePanelY))}}},{key:"_pinchEnd",value:function(e){var t=this;this.canScale&&(this.scale=(0,o.isNumber)(e)?e:this.currentScale,this.realWidth=this.panelEl.clientWidth*this.scale,this.realHeight=this.panelEl.clientHeight*this.scale,this.allowDistanceX=(this.realWidth-this.width)/2/this.scale+2,this.allowDistanceY=(this.realHeight-this.height)/2/this.scale+2,(this.realWidth<this.width||this.realHeight<this.height)&&(this.addAnimation(),this._initImage(!1)),window.requestAnimationFrame(function(){t.isScale()?r.default.getLock(s.LOCK_NAME):r.default.releaseLock(s.LOCK_NAME),t.panelEl.style.willChange="auto"}))}},{key:"_calculate",value:function(e,t){return e>0?e-t:e+t}},{key:"_translatePanelStart",value:function(){this.removeAnimation()}},{key:"_translatePanel",value:function(e){var t=0,i=e.deltaX,n=e.deltaY;this.realWidth<=this.width&&i?this.imageViewer._dealWithMoveAction({deltaX:i},!0):(this.allowDistanceX>0&&i&&(this.currentPanelX=i/this.scale+this.translatePanelX,this.needResetX=!(-this.allowDistanceX<this.currentPanelX&&this.currentPanelX<this.allowDistanceX)),this.needResetX?(this.imageViewer._dealWithMoveAction({deltaX:this._calculate(this.currentPanelX,this.allowDistanceX)},!0),t=this.currentPanelX>0?this.allowDistanceX:-this.allowDistanceX):(this.imageViewer._dealWithMoveAction({deltaX:0},!0),t=this.currentPanelX)),this.allowDistanceY>0&&n&&(this.currentPanelY=n/this.scale+this.translatePanelY,this.needResetY=!(-this.allowDistanceY<this.currentPanelY&&this.currentPanelY<this.allowDistanceY)),(0,a.setScaleAndTranslateStyle)(this.panelEl,this.scale,t,this.currentPanelY)}},{key:"_translatePanelEnd",value:function(e){var t=this,i=!1,n=e.deltaX;this.realWidth<=this.width&&n?i=this.imageViewer._dealWithMoveActionEnd({deltaX:n},!0):this.needResetX&&(i=this.imageViewer._dealWithMoveActionEnd({deltaX:this._calculate(this.currentPanelX,this.allowDistanceX)},!0)),i?(this._initImage(!0),window.requestAnimationFrame(function(){r.default.releaseLock(s.LOCK_NAME)})):(this.needResetX?this.translatePanelX=this.currentPanelX>0?this.allowDistanceX:-this.allowDistanceX:this.translatePanelX=this.currentPanelX,this.needResetY?this.translatePanelY=this.currentPanelY>0?this.allowDistanceY:-this.allowDistanceY:this.translatePanelY=this.currentPanelY,(this.needResetX||this.needResetY)&&window.requestAnimationFrame(function(){t.addAnimation(),(0,a.setScaleAndTranslateStyle)(t.panelEl,t.scale,t.translatePanelX,t.translatePanelY)}),this.needResetX=this.needResetY=!1)}},{key:"isScale",value:function(){return Math.abs(this.scale-1)>.001}},{key:"addAnimation",value:function(){this.panelEl.classList.add(s.ITEM_ANIMATION_CLASS),this.el.classList.add(s.ITEM_ANIMATION_CLASS)}},{key:"removeAnimation",value:function(){this.panelEl.classList.remove(s.ITEM_ANIMATION_CLASS),this.el.classList.remove(s.ITEM_ANIMATION_CLASS)}},{key:"clearImg",value:function(){this.src="",this.imageEl.src="",this.imageOption=null}}]),e}();t.default=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test-passive",null,a)}catch(e){}t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=r(i(0)),s=r(i(12));function r(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=0,h=function(){function e(t){l(this,e),this.time=(new Date).getTime(),this.srcEvent=t,this.type=[],this.deltaX=0,this.deltaY=0,this.scale=1,this._getTouches(),this.preventDefault(),this.stopPropagation()}return n(e,[{key:"_getTouches",value:function(){var e=this.srcEvent.touches.length?this.srcEvent.touches:this.srcEvent.changedTouches;this.touches=Array.prototype.slice.call(e,0)}},{key:"stopPropagation",value:function(){this.srcEvent.stopPropagation&&this.srcEvent.stopPropagation()}},{key:"preventDefault",value:function(){this.srcEvent.preventDefault&&this.srcEvent.preventDefault()}}]),e}(),c=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(this,e),t&&(this.id=++o,this.el=t,this.threshold=4,this.enableScale=!!i.enableScale,this.hasTriggerStart=!1,this._doubleTapStartEvent=null,this._startEvent=null,this._moveEvent=null,this.tapTimeoutId=null,this.isTapStart=!1,this._commonEvent=new a.default,this._bindEvent())}return n(e,[{key:"_cancelTap",value:function(){this.tapTimeoutId&&(clearTimeout(this.tapTimeoutId),this.isTapStart=!1)}},{key:"_bindEvent",value:function(){var e=!!s.default&&{passive:!1};this.el.addEventListener("touchstart",this,e),this.el.addEventListener("touchmove",this,e),this.el.addEventListener("touchend",this,e),this.el.addEventListener("touchcancel",this,e)}},{key:"_start",value:function(e){var t=this;this._startEvent=new h(e),this._startEvent.touches.length>1?this._cancelTap():(this.isTapStart=!0,this.tapTimeoutId=setTimeout(function(){t._cancelTap()},300))}},{key:"_move",value:function(e){var t=this._startEvent;if(t){var i=!1,n=new h(e);n.deltaX=n.touches[0].clientX-t.touches[0].clientX,n.deltaY=n.touches[0].clientY-t.touches[0].clientY,(Math.abs(n.deltaX)>this.threshold||Math.abs(n.deltaY)>this.threshold)&&(n.type.push("pan"),i=!0);var a=1;if(this.enableScale&&t.touches.length>1&&n.touches.length>1){var s=Math.abs(n.touches[0].clientX-n.touches[1].clientX),r=Math.abs(n.touches[0].clientY-n.touches[1].clientY),l=Math.abs(t.touches[0].clientX-t.touches[1].clientX),o=Math.abs(t.touches[0].clientY-t.touches[1].clientY);a=Math.sqrt(s*s+r*r)/Math.sqrt(l*l+o*o),n.type.push("pinch")}n.scale=a,i&&(this.hasTriggerStart||(this.hasTriggerStart=!0,n.type.includes("pinch")&&this._commonEvent.emit("pinchstart",t),n.type.includes("pan")&&this._commonEvent.emit("panstart",t)),n.type.includes("pinch")&&this._commonEvent.emit("pinch",n),n.type.includes("pan")&&this._commonEvent.emit("panmove",n),this._moveEvent=n)}}},{key:"_end",value:function(e){var t=this._startEvent;if(t){var i=this._moveEvent;if(i)i.type.includes("pinch")&&this._commonEvent.emit("pinchend",i),i.type.includes("pan")&&this._commonEvent.emit("panend",i),this.hasTriggerStart=!1,this._startEvent=null,this._moveEvent=null;else{var n=new h(e);if(this.isTapStart&&(n.type=["tap"],this._commonEvent.emit("tap",n)),1===t.touches.length&&1===n.touches.length)if(this._doubleTapStartEvent)n.time-this._doubleTapStartEvent.time<300&&(n.type=["doubleTap"],this._commonEvent.emit("doubleTap",n)),this._doubleTapStartEvent=null;else this._doubleTapStartEvent=this._startEvent;else this._doubleTapStartEvent=null}}this._cancelTap()}},{key:"_cancel",value:function(){this._startEvent=null,this.hasTriggerStart=!1}},{key:"handleEvent",value:function(e){switch(e.type){case"touchstart":this._start(e);break;case"touchmove":this._move(e);break;case"touchend":this._end(e);break;case"touchcancel":this._cancel(e)}}},{key:"on",value:function(e,t){this._commonEvent.on(e,t)}}]),e}();t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.debug=function(e){window.console.log("[ImageViewer]:"+e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(14),s=i(4),r=i(3),l=i(2),o=d(i(1)),h=d(i(13)),c=d(i(11)),u=d(i(10));function d(e){return e&&e.__esModule?e:{default:e}}var f={thumbnail:"",url:""},v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opt=i,this.duration=this.opt.duration||14,this.el=null,this.headerEl=null,this.bodyEl=null,this.footerEl=null,this.viewerWrapperEl=null,this.animationEl=null,this.currentNumberEl=null,this.totalNumberEl=null,this.images=t,this.imagesLength=t.length,this.container=i.container||"body",this.enableScale=!!i.enableScale,this.currentIndex=i.startIndex||0,this.viewers=[],this.scaleStart=1,this.isScale=!1,this.isMove=!1,this.width=0,this.height=0,this.itemList=[],this.translateX=0,this.touch=null}return n(e,[{key:"_create",value:function(){this.el=(0,s.query)(".image-viewer")[0],this.destroy();var e=document.createElement("div");e.innerHTML=u.default,this.el=e.firstElementChild,(0,s.query)(this.container)[0].appendChild(this.el),this.headerEl=(0,s.query)(".image-header",this.el)[0],this.bodyEl=(0,s.query)(".image-body",this.el)[0],this.footerEl=(0,s.query)(".image-footer",this.el)[0],this.viewerWrapperEl=(0,s.query)(".image-body .viewer-wrapper",this.el)[0],this.animationEl=(0,s.query)(".image-animation",this.el)[0],this.itemList=this.viewerWrapperEl.children,this.width=this.el.clientWidth,this.height=this.el.clientHeight,this.opt.headerRender&&(this.headerEl.innerHTML=this.opt.headerRender()),this.opt.footerRender&&(this.footerEl.innerHTML=this.opt.footerRender()),this.currentNumberEl=(0,s.query)(".number-current",this.el)[0],this.totalNumberEl=(0,s.query)(".number-total",this.el)[0]}},{key:"_init",value:function(){this.viewers=[];for(var e,t=0,i=this.itemList.length;t<i;t++)e=this.itemList[t],this.viewers.push(new c.default(this,e,this.width,this.height,t));o.default.createLock(r.LOCK_NAME)}},{key:"_updateCountElement",value:function(){this.currentNumberEl&&(this.currentNumberEl.innerText=this.currentIndex+1),this.totalNumberEl&&(this.totalNumberEl.innerText=this.imagesLength)}},{key:"_bindEvent",value:function(){var e=this,t=new h.default(this.bodyEl,{enableScale:this.enableScale});t.on("tap",function(){return e._dealTap()}),t.on("panstart",function(t){return e._dealPanAction(t,"panstart")}),t.on("panmove",function(t){return e._dealPanAction(t,"panmove")}),t.on("panend",function(t){return e._dealPanAction(t,"panend")}),this.enableScale&&(t.on("pinchstart",function(t){return e._dealScaleAction(t,"pinchstart")}),t.on("pinch",function(t){return e._dealScaleAction(t,"pinch")}),t.on("pinchend",function(t){return e._dealScaleAction(t,"pinchend")})),this.touch=t}},{key:"_dealTap",value:function(){this._getCurrentViewer().isScale()?this.reset():this.opt.enableTapClose&&this.close()}},{key:"_dealPanAction",value:function(e,t){if(!this.isScale)switch(t){case"panstart":this._dealWithMoveActionStart(e);break;case"panmove":this._dealWithMoveAction(e);break;case"panend":this._dealWithMoveActionEnd(e)}}},{key:"_dealScaleAction",value:function(e,t){if(!this.isMove)switch(t){case"pinchstart":this._dealWithScaleActionStart(e);break;case"pinch":this._dealWithScaleAction(e);break;case"pinchend":this._dealWithScaleActionEnd(e)}}},{key:"_dealWithMoveActionStart",value:function(e){this.isMove=!0,o.default.getLockState(r.LOCK_NAME)?this._getCurrentViewer()._translatePanelStart(e):(this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),this.opt.beforeSwipe&&this.opt.beforeSwipe(this.currentIndex),this.viewerWrapperEl.style.willChange="transform")}},{key:"_dealWithMoveAction",value:function(e,t){o.default.getLockState(r.LOCK_NAME)&&!t?this._getCurrentViewer()._translatePanel(e):(t&&this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX+e.deltaX,0))}},{key:"_dealWithMoveActionEnd",value:function(e,t){var i=this,n=!1;if(o.default.getLockState(r.LOCK_NAME)&&!t)this._getCurrentViewer()._translatePanelEnd(e);else{var a=e.deltaX,l=!1;0===this.currentIndex&&a>0&&this.opt.swipeFirstRight?l=this.opt.swipeFirstRight(this,Math.abs(a)):this.currentIndex===this.imagesLength-1&&a<0&&this.opt.swipeLastLeft&&(l=this.opt.swipeLastLeft(this,Math.abs(a))),l||(0!==a&&this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),0!==a&&this._checkDistance(a)?(this.viewers.forEach(function(e){return e.removeAnimation()}),n=a>0?this.swipeToPrev():this.swipeToNext()):(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),this.opt.afterSwipe&&this.opt.afterSwipe(this.currentIndex)),this.viewerWrapperEl.style.willChange="auto"}return window.requestAnimationFrame(function(){i.isMove=!1}),n}},{key:"_dealWithScaleActionStart",value:function(e){this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),this.isScale=!0,this.scaleStart=e.scale,this._getCurrentViewer()._pinchStart()}},{key:"_dealWithScaleAction",value:function(e){this._getCurrentViewer()._pinch(e.scale-this.scaleStart)}},{key:"_dealWithScaleActionEnd",value:function(){var e=this;this._getCurrentViewer()._pinchEnd(),window.requestAnimationFrame(function(){e.isScale=!1})}},{key:"_getCurrentViewer",value:function(){return this.viewers[1]}},{key:"_checkDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.abs(e)>this.width/5}},{key:"_getPrevImage",value:function(){var e=this.currentIndex;return this.opt.loop&&this.imagesLength>2&&(e=0===this.currentIndex?this.imagesLength:this.currentIndex),this.images[e-1]||f}},{key:"_getCurrentImage",value:function(){return this.images[this.currentIndex]||f}},{key:"_getNextImage",value:function(){var e=this.currentIndex;return this.opt.loop&&this.imagesLength>2&&(e=this.currentIndex===this.imagesLength-1?-1:this.currentIndex),this.images[e+1]||f}},{key:"_getSpecificImage",value:function(e){return this.images[e]||f}},{key:"_getPositionAndSize",value:function(e){if((0,l.isPlainObject)(e))return{top:e.top||0,left:e.left||0,width:e.width||0,height:e.height||0};if(e.getBoundingClientRect){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}return{top:0,left:0,width:0,height:0}}},{key:"_animation",value:function(e,t,i){var n=this,a=this.duration,r=this.animationEl.style,l=this._getCurrentViewer(),o=1===t?this.opt.fadeInFn(this.currentIndex):l.el,h=1===t?l.el:this.opt.fadeInFn(this.currentIndex),c=this._getPositionAndSize(o),u=this._getPositionAndSize(h),d=(u.top-c.top)/a,f=(u.left-c.left)/a,v=(u.width-c.width)/c.width/a,p=(u.height-c.height)/c.height/a,m=1/a,g=0;r.top=c.top+"px",r.left=c.left+"px",r.width=c.width+"px",r.height=c.height+"px";this.animationEl.children[0].src=e,this.animationEl.classList.remove("hide"),function e(){++g<=a?(r.width=(1+v*g)*c.width+"px",r.height=(1+p*g)*c.height+"px",(0,s.setTranslateStyle)(n.animationEl,f*g,d*g),n.bodyEl.style.opacity=1===t?m*g:1-m*g,window.requestAnimationFrame(e)):window.requestAnimationFrame(function(){n.animationEl.classList.add("hide"),i()})}()}},{key:"_fadeIn",value:function(e){if(this.opt.fadeInFn){var t=this._getCurrentImage();this._animation(t.thumbnail||t.url,1,e)}else e()}},{key:"_fadeOut",value:function(e){if(this.opt.fadeOutFn){var t=this._getCurrentImage();this._animation(t.url,2,e)}else e()}},{key:"reset",value:function(){var e=this.viewers[1];e.addAnimation(),e._initImage(!0),window.requestAnimationFrame(function(){o.default.releaseLock(r.LOCK_NAME)})}},{key:"loopViewers",value:function(e){var t=null;return 0===e?(t=this.viewers.shift(),this.viewers.push(t)):1===e&&(t=this.viewers.pop(),this.viewers=[t].concat(this.viewers)),t}},{key:"swipeToPrev",value:function(){if(this._getPrevImage().url){this.currentIndex--,this.translateX+=this.width,this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0);var e=this._getSpecificImage(this.currentIndex-1);if(e.url||0===this.currentIndex){var t=this.loopViewers(1);t.init(e,t.displayIndex-3,!0),this._getCurrentViewer().init(),this._updateCountElement()}return!0}return(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),!1}},{key:"swipeToNext",value:function(){if(this._getNextImage().url){this.currentIndex++,this.translateX-=this.width,this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0);var e=this._getSpecificImage(this.currentIndex+1);if(e.url||this.currentIndex===this.imagesLength-1){var t=this.loopViewers(0);t.init(e,t.displayIndex+3,!0),this._getCurrentViewer().init(),this._updateCountElement()}return!0}return(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),!1}},{key:"swipeInByIndex",value:function(e,t,i){(0,l.isNumber)(e)&&e>-1&&e<this.imagesLength?(this.currentIndex=e,this.translateX=0,(0,s.setTranslateStyle)(this.viewerWrapperEl,0,0),this.viewers=this.viewers.sort(function(e,t){return e.index-t.index}),this.viewers[0].init(this._getPrevImage(),r.LEFT_IMG,!0),this.viewers[1].init(this._getCurrentImage(),r.CENTER_IMG,!0,t,i),this.viewers[2].init(this._getNextImage(),r.RIGHT_IMG,!0),this._updateCountElement()):(0,a.debug)("illegal index!")}},{key:"setImageOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.length||(0,a.debug)("images array can not be empty!"),this.images=e,this.imagesLength=e.length,this.currentIndex=t,this.swipeInByIndex(this.currentIndex)}},{key:"destroy",value:function(){this.el&&(0,s.removeElement)(this.el)}},{key:"close",value:function(){var e=this;this.el&&(this.viewerWrapperEl.style.visibility="hidden",this._fadeOut(function(){e.animationEl.children[0].src="",e._getCurrentViewer().clearImg(),e.el.style.display="none"}))}},{key:"open",value:function(e){var t=this;this.currentIndex=(0,l.isNumber)(e)?e:this.currentIndex,this.el||(this._create(),this._init(),this._bindEvent()),this.opt.fadeInFn&&(this.bodyEl.style.opacity=0,this.viewerWrapperEl.style.visibility="hidden"),this.el.style.display="block",this.swipeInByIndex(this.currentIndex,!1,function(){t._getCurrentViewer().removeAnimation(),window.requestAnimationFrame(function(){t._fadeIn(function(){t.bodyEl.style.opacity=1,t.viewerWrapperEl.style.visibility="visible",t.swipeInByIndex(t.currentIndex)})})})}}]),e}();t.default=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=0,t=["webkit","moz"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16.7-(i-e)),a=window.setTimeout(function(){t(i+n)},n);return e=i+n,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(16)),a=s(i(15));s(i(9));function s(e){return e&&e.__esModule?e:{default:e}}(0,n.default)(),a.default.version="2.1.2",t.default=a.default}]).default});