!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ImageViewer=t():e.ImageViewer=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enableMultiple=t,this._handlers={}}return n(e,[{key:"addHandlers",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(i=void 0===i?this._enableMultiple:i)?(this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push({once:n,fn:t})):this._handlers[e]=[{once:n,fn:t}]}},{key:"on",value:function(e,t,i){this.addHandlers(e,t,i,!1)}},{key:"once",value:function(e,t,i){this.addHandlers(e,t,i,!0)}},{key:"off",value:function(e){delete this._handlers[e]}},{key:"emit",value:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var a=this._handlers[e]||[];if(a.length){var s=[];a.forEach(function(e){!e.once&&s.push(e),e.fn.apply(e,i)}),this._handlers[e]=s}}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._locks={}}return n(e,[{key:"createLock",value:function(e){this._locks[e]=!1}},{key:"deleteLock",value:function(e){delete this._locks[e]}},{key:"getLock",value:function(e){this._locks[e]=!0}},{key:"releaseLock",value:function(e){this._locks[e]=!1}},{key:"getLockState",value:function(e){return this._locks[e]}}]),e}();t.default=new a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isNumber=function(e){return parseFloat(e)===e},t.isPlainObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOAD_IMG_COMPLETE="LOAD_IMG_COMPLETE",t.LOAD_IMG_FAIL="LOAD_IMG_FAIL",t.LOCK_NAME="STOP_SWIPE",t.ITEM_ANIMATION_CLASS="viewer-animation",t.LEFT_IMG=-1,t.CENTER_IMG=0,t.RIGHT_IMG=1},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a,s=(n=document.createElement("div").style,a="",["transform","webkitTransform","MozTransform","oTransform","msTransform"].forEach(function(e){void 0!==n[e]&&(a=e)}),a);t.query=function(e,t){return(t=t||document).querySelectorAll(e)},t.removeElement=function(e){var t=e.parentNode;t&&t.removeChild(e)},t.setTranslateStyle=function(e,t,i){e.style[s]="translate3d("+t+"px,"+i+"px,0)"},t.setScaleAndTranslateStyle=function(e,t,i,n){e.style[s]="translate3d("+i+"px,"+n+"px,0) scale("+t+")"}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var a,s=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?e:(a=0===s.indexOf("//")?s:0===s.indexOf("/")?i+s:n+s.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")})}},function(e,t,i){var n,a,s={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=n.apply(this,arguments)),a}),o=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var i=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}}(),l=null,h=0,c=[],u=i(5);function d(e,t){for(var i=0;i<e.length;i++){var n=e[i],a=s[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(w(n.parts[r],t))}else{var o=[];for(r=0;r<n.parts.length;r++)o.push(w(n.parts[r],t));s[n.id]={id:n.id,refs:1,parts:o}}}}function f(e,t){for(var i=[],n={},a=0;a<e.length;a++){var s=e[a],r=t.base?s[0]+t.base:s[0],o={css:s[1],media:s[2],sourceMap:s[3]};n[r]?n[r].parts.push(o):i.push(n[r]={id:r,parts:[o]})}return i}function v(e,t){var i=o(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),c.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=o(e.insertInto+" "+e.insertAt.before);i.insertBefore(t,a)}}function p(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function m(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),g(t,e.attrs),v(e,t),t}function g(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}function w(e,t){var i,n,a,s;if(t.transform&&e.css){if(!(s=t.transform(e.css)))return function(){};e.css=s}if(t.singleton){var r=h++;i=l||(l=m(t)),n=_.bind(null,i,r,!1),a=_.bind(null,i,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),v(e,t),t}(t),n=function(e,t,i){var n=i.css,a=i.sourceMap,s=void 0===t.convertToAbsoluteUrls&&a;(t.convertToAbsoluteUrls||s)&&(n=u(n));a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var r=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}.bind(null,i,t),a=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=m(t),n=function(e,t){var i=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}.bind(null,i),a=function(){p(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=f(e,t);return d(i,t),function(e){for(var n=[],a=0;a<i.length;a++){var r=i[a];(o=s[r.id]).refs--,n.push(o)}e&&d(f(e,t),t);for(a=0;a<n.length;a++){var o;if(0===(o=n[a]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete s[o.id]}}}};var y,b=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function _(e,t,i,n){var a=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,a);else{var s=document.createTextNode(a),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var a=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),s=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[i].concat(s).concat([a]).join("\n")}var r;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},a=0;a<this.length;a++){var s=this[a][0];"number"==typeof s&&(n[s]=!0)}for(a=0;a<e.length;a++){var r=e[a];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),t.push(r))}},t}},function(e,t,i){(e.exports=i(7)(!1)).push([e.i,".image-viewer{position:fixed;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden;touch-action:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0)}.image-viewer.animation{pointer-events:none}.image-viewer.animation .image-viewer-bg{will-change:opacity;transition:opacity 333ms cubic-bezier(.4,0,.22,1)}.image-viewer.animation .image-animation{will-change:transform;transition:-webkit-transform 333ms cubic-bezier(.4,0,.22,1);transition:transform 333ms cubic-bezier(.4,0,.22,1);transition:transform 333ms cubic-bezier(.4,0,.22,1),-webkit-transform 333ms cubic-bezier(.4,0,.22,1)}.image-viewer .viewer-animation{transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.image-viewer .viewer{display:inline-block;position:absolute;top:0;left:0;width:100%;text-align:center;-webkit-backface-visibility:hidden;backface-visibility:hidden}.image-viewer .image-viewer-bg{position:absolute;top:0;left:0;width:100%;height:100%;opacity:.001;background-color:#000;z-index:1}.image-viewer .image-header{position:absolute;top:0;left:0;width:100%;color:#fff;font-size:12px;z-index:12}.image-viewer .image-body{position:absolute;top:0;left:0;width:100%;z-index:10}.image-viewer .image-body,.image-viewer .image-body .viewer-wrapper{height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.image-viewer .image-body .viewer-wrapper{font-size:0;will-change:transform}.image-viewer .image-body .panel{display:inline-block;overflow:hidden;will-change:transform}.image-viewer .image-body .panel img{max-width:100%;max-height:100%;max-width:100vw;max-height:100vh;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transform:translateZ(0);transform:translateZ(0)}.image-viewer .image-body .panel span{font-size:12px;color:#fff}.image-viewer .image-footer{position:absolute;left:0;bottom:0;width:100%;color:#fff;font-size:12px;z-index:12;-webkit-transform:translateZ(0);transform:translateZ(0)}.image-viewer .image-animation{position:absolute;top:0;left:0;z-index:5;text-align:center;transition:none;-webkit-transform-origin:left top;transform-origin:left top;-webkit-backface-visibility:hidden;backface-visibility:hidden}.image-viewer .image-animation img{max-width:100%;max-height:100%}.image-viewer .image-animation.hide{display:none}.image-viewer .ball-clip-rotate{position:absolute;top:50%;left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:100%;z-index:11;text-align:center}.image-viewer .ball-clip-rotate>div{display:inline-block;width:26px;height:26px;border-radius:100%;border:2px solid #fff;border-bottom-color:transparent;background:0 0;-webkit-animation:ballRotate .75s 0s linear infinite;animation:ballRotate .75s 0s linear infinite}.image-viewer .ball-clip-rotate.hide{display:none}@-webkit-keyframes ballRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes ballRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},function(e,t,i){var n=i(8);"string"==typeof n&&(n=[[e.i,n,""]]);var a={sourceMap:!1,hmr:!0,transform:void 0,insertInto:void 0};i(6)(n,a);n.locals&&(e.exports=n.locals)},function(e,t){e.exports='<div class=image-viewer> <div class=image-viewer-bg></div> <div class=image-header></div> <div class=image-body> <div class=viewer-wrapper> <div class=viewer> <div class=panel><img><span></span></div> <div class="ball-clip-rotate hide"> <div></div> </div> </div> <div class=viewer> <div class=panel><img><span></span></div> <div class="ball-clip-rotate hide"> <div></div> </div> </div> <div class=viewer> <div class=panel><img><span></span></div> <div class="ball-clip-rotate hide"> <div></div> </div> </div> </div> </div> <div class=image-footer></div> <div class="image-animation hide"><img></div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(4),s=i(3),r=h(i(1)),o=h(i(0)),l=i(2);function h(e){return e&&e.__esModule?e:{default:e}}var c=0,u=function(){},d=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=++c,this.src="",this.event=new o.default(!1),this.imageViewer=t,this.el=i,this.panelEl=i.firstElementChild,this.imageEl=(0,a.query)("img",this.el)[0],this.tipsEl=(0,a.query)("span",this.el)[0],this.loadingEl=(0,a.query)(".ball-clip-rotate",this.el)[0],this.imageOption=null,this.index=n,this.displayIndex=0,this.canScale=!1,this.scale=1,this.currentScale=1,this.realWidth=0,this.realHeight=0,this.translateX=0,this.translateY=0,this.translatePanelX=0,this.translatePanelY=0,this.currentPanelX=0,this.currentPanelY=0,this.allowDistanceX=0,this.allowDistanceY=0,this.needResetX=!1,this.needResetY=!1,this._bindEvent()}return n(e,[{key:"_initImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;e&&(this.scale=1,this.allowDistanceX=this.allowDistanceY=0),this.translatePanelX=0,this.translatePanelY=0,this.currentPanelX=0,this.currentPanelY=0,this.realWidth=this.panelEl.clientWidth*this.scale,this.realHeight=this.panelEl.clientHeight*this.scale,this.translateX=this.displayIndex*this.imageViewer.width,this.translateY=(this.imageViewer.height-this.el.clientHeight)/2,this.needResetX=this.needResetY=!1,(0,a.setScaleAndTranslateStyle)(this.panelEl,this.scale,this.translatePanelX,this.translatePanelY),(0,a.setTranslateStyle)(this.el,this.translateX,this.translateY),t()}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.imageOption,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.displayIndex,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u,o="",l=function(e){(n.src===o||e)&&(n.canScale=!0,n.tipsEl.innerText="",n.imageEl.style.display="",n._initImage(i,r))},h=function(e){(n.src===o||e)&&(n.imageEl.style.display="none",o&&n.isActive()?(n._initImage(i),n.tipsEl.innerText="load image fail"):n.tipsEl.innerText="",r())};if(this.canScale=!1,this.imageOption=e,this.displayIndex=t,this.hideLoading(),a&&e.thumbnail){if(e._hasLoadLarge)return o=e.url,this.event.once(s.LOAD_IMG_COMPLETE,l),void this._setImageUrl(o);if(o=e.thumbnail,this.isActive()&&e.url&&(this.showLoading(),this.loadImg(e.url,function(){n.isActive()&&(n.event.once(s.LOAD_IMG_COMPLETE,function(){l(!0)}),n._setImageUrl(e.url))},function(){n.isActive()&&h(!0)},function(){n.hideLoading(),e._hasLoadLarge=!0})),1===a)return}else o=e.url;this.event.once(s.LOAD_IMG_COMPLETE,l),this.event.once(s.LOAD_IMG_FAIL,h),this._setImageUrl(o)}},{key:"_setImageUrl",value:function(e){this.imageEl.src=this.src=e}},{key:"loadImg",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],a=new Image;a.src=e,a.width||a.height?(t(),n()):(a.onload=function(){t(),n()},a.onerror=function(){i(),n()})}},{key:"showLoading",value:function(){this.loadingEl.classList.remove("hide")}},{key:"hideLoading",value:function(){this.loadingEl.classList.add("hide")}},{key:"isActive",value:function(){return this.imageViewer._getCurrentViewer().id===this.id}},{key:"_bindEvent",value:function(){var e=this;this.imageEl.addEventListener("load",function(){e.event.emit(s.LOAD_IMG_COMPLETE)},!1),this.imageEl.addEventListener("error",function(){e.event.emit(s.LOAD_IMG_FAIL)},!1)}},{key:"_pinchStart",value:function(){this.canScale&&this.removeAnimation()}},{key:"_pinch",value:function(e){if(this.canScale){var t=e*this.scale+this.scale;t>.5&&t<8&&(this.currentScale=t,(0,a.setScaleAndTranslateStyle)(this.panelEl,this.currentScale,this.translatePanelX,this.translatePanelY))}}},{key:"_pinchEnd",value:function(e){var t=this;if(this.canScale){this.scale=(0,l.isNumber)(e)?e:this.currentScale,this.realWidth=this.panelEl.clientWidth*this.scale,this.realHeight=this.panelEl.clientHeight*this.scale,this.allowDistanceX=(this.realWidth-this.imageViewer.width)/2+2,this.allowDistanceY=(this.realHeight-this.imageViewer.height)/2+2;var i=this.panelEl.getBoundingClientRect();(this.realWidth<this.imageViewer.width||this.realHeight<this.imageViewer.height||i.left>0||i.right<this.imageViewer.width||i.top>0||i.bottom<this.imageViewer.height)&&(this.addAnimation(),this._initImage(!1)),setTimeout(function(){t.isScale()?r.default.getLock(s.LOCK_NAME):r.default.releaseLock(s.LOCK_NAME)},0)}}},{key:"_calculate",value:function(e,t){return e>0?e-t:e+t}},{key:"_translatePanelStart",value:function(){this.removeAnimation()}},{key:"_translatePanel",value:function(e){var t=0,i=e.deltaX,n=e.deltaY;this.realWidth<=this.imageViewer.width&&i?this.imageViewer._dealWithMoveAction({deltaX:i},!0):(this.allowDistanceX>0&&i&&(this.currentPanelX=i+this.translatePanelX,this.needResetX=!(-this.allowDistanceX<this.currentPanelX&&this.currentPanelX<this.allowDistanceX)),this.needResetX?(this.imageViewer._dealWithMoveAction({deltaX:this._calculate(this.currentPanelX,this.allowDistanceX)},!0),t=this.currentPanelX>0?this.allowDistanceX:-this.allowDistanceX):(this.imageViewer._dealWithMoveAction({deltaX:0},!0),t=this.currentPanelX)),this.allowDistanceY>0&&n&&(this.currentPanelY=n+this.translatePanelY,this.needResetY=!(-this.allowDistanceY<this.currentPanelY&&this.currentPanelY<this.allowDistanceY)),(0,a.setScaleAndTranslateStyle)(this.panelEl,this.scale,t,this.currentPanelY)}},{key:"_translatePanelEnd",value:function(e){var t=this,i=!1,n=e.deltaX;this.realWidth<=this.imageViewer.width&&n?i=this.imageViewer._dealWithMoveActionEnd({deltaX:n},!0):this.needResetX&&(i=this.imageViewer._dealWithMoveActionEnd({deltaX:this._calculate(this.currentPanelX,this.allowDistanceX)},!0)),i?(this._initImage(!0),setTimeout(function(){r.default.releaseLock(s.LOCK_NAME)},0)):(this.needResetX?this.translatePanelX=this.currentPanelX>0?this.allowDistanceX:-this.allowDistanceX:this.translatePanelX=this.currentPanelX,this.needResetY?this.translatePanelY=this.currentPanelY>0?this.allowDistanceY:-this.allowDistanceY:this.translatePanelY=this.currentPanelY,(this.needResetX||this.needResetY)&&setTimeout(function(){t.addAnimation(),(0,a.setScaleAndTranslateStyle)(t.panelEl,t.scale,t.translatePanelX,t.translatePanelY)},0),this.needResetX=this.needResetY=!1)}},{key:"isScale",value:function(){return Math.abs(this.scale-1)>.001}},{key:"addAnimation",value:function(){this.el.classList.add(s.ITEM_ANIMATION_CLASS),this.panelEl.classList.add(s.ITEM_ANIMATION_CLASS)}},{key:"removeAnimation",value:function(){this.el.classList.remove(s.ITEM_ANIMATION_CLASS),this.panelEl.classList.remove(s.ITEM_ANIMATION_CLASS)}},{key:"clearImg",value:function(){this.src="",this.imageEl.src="",this.imageOption=null}}]),e}();t.default=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test-passive",null,a)}catch(e){}t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=r(i(0)),s=r(i(12));function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=0,h=function(){function e(t){o(this,e),this.time=(new Date).getTime(),this.srcEvent=t,this.type=[],this.deltaX=0,this.deltaY=0,this.scale=1,this._getTouches(),this.preventDefault(),this.stopPropagation()}return n(e,[{key:"_getTouches",value:function(){var e=this.srcEvent.touches.length?this.srcEvent.touches:this.srcEvent.changedTouches;this.touches=Array.prototype.slice.call(e,0)}},{key:"stopPropagation",value:function(){this.srcEvent.stopPropagation&&this.srcEvent.stopPropagation()}},{key:"preventDefault",value:function(){this.srcEvent.preventDefault?this.srcEvent.preventDefault():this.srcEvent.returnValue=!1}}]),e}(),c=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),t&&(this.id=++l,this.el=t,this.threshold=4,this.enableScale=!!i.enableScale,this.hasTriggerStart=!1,this._doubleTapStartEvent=null,this._startEvent=null,this._moveEvent=null,this.tapTimeoutId=null,this.isTapStart=!1,this._commonEvent=new a.default,this._bindEvent())}return n(e,[{key:"_cancelTap",value:function(){this.tapTimeoutId&&(clearTimeout(this.tapTimeoutId),this.isTapStart=!1)}},{key:"_bindEvent",value:function(){var e=!!s.default&&{passive:!1};this.el.addEventListener("touchstart",this,e),this.el.addEventListener("touchmove",this,e),this.el.addEventListener("touchend",this,e),this.el.addEventListener("touchcancel",this,e)}},{key:"_start",value:function(e){var t=this;this._startEvent=new h(e),this._startEvent.touches.length>1?this._cancelTap():(this.isTapStart=!0,this.tapTimeoutId=setTimeout(function(){t._cancelTap()},300))}},{key:"_move",value:function(e){var t=this._startEvent;if(t){var i=!1,n=new h(e);n.deltaX=n.touches[0].clientX-t.touches[0].clientX,n.deltaY=n.touches[0].clientY-t.touches[0].clientY,(Math.abs(n.deltaX)>this.threshold||Math.abs(n.deltaY)>this.threshold)&&(n.type.push("pan"),i=!0);var a=1;if(this.enableScale&&t.touches.length>1&&n.touches.length>1){var s=Math.abs(n.touches[0].clientX-n.touches[1].clientX),r=Math.abs(n.touches[0].clientY-n.touches[1].clientY),o=Math.abs(t.touches[0].clientX-t.touches[1].clientX),l=Math.abs(t.touches[0].clientY-t.touches[1].clientY);a=Math.sqrt(s*s+r*r)/Math.sqrt(o*o+l*l),n.type.push("pinch")}n.scale=a,i&&(this.hasTriggerStart||(this.hasTriggerStart=!0,n.type.indexOf("pinch")>-1&&this._commonEvent.emit("pinchstart",t),n.type.indexOf("pan")>-1&&this._commonEvent.emit("panstart",t)),n.type.indexOf("pinch")>-1&&this._commonEvent.emit("pinch",n),n.type.indexOf("pan")>-1&&this._commonEvent.emit("panmove",n),this._moveEvent=n)}}},{key:"_end",value:function(e){var t=this._startEvent;if(t){var i=this._moveEvent;if(i)i.type.indexOf("pinch")>-1&&this._commonEvent.emit("pinchend",i),i.type.indexOf("pan")>-1&&this._commonEvent.emit("panend",i),this.hasTriggerStart=!1,this._startEvent=null,this._moveEvent=null;else{var n=new h(e);if(this.isTapStart&&(n.type=["tap"],this._commonEvent.emit("tap",n)),1===t.touches.length&&1===n.touches.length)if(this._doubleTapStartEvent)n.time-this._doubleTapStartEvent.time<300&&(n.type=["doubleTap"],this._commonEvent.emit("doubleTap",n)),this._doubleTapStartEvent=null;else this._doubleTapStartEvent=this._startEvent;else this._doubleTapStartEvent=null}}this._cancelTap()}},{key:"_cancel",value:function(){this._startEvent=null,this.hasTriggerStart=!1}},{key:"handleEvent",value:function(e){switch(e.type){case"touchstart":this._start(e);break;case"touchmove":this._move(e);break;case"touchend":this._end(e);break;case"touchcancel":this._cancel(e)}}},{key:"on",value:function(e,t){this._commonEvent.on(e,t)}}]),e}();t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.debug=function(e){window.console.log("[ImageViewer]:",e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(14),s=i(4),r=i(3),o=i(2),l=f(i(0)),h=f(i(1)),c=f(i(13)),u=f(i(11)),d=f(i(10));function f(e){return e&&e.__esModule?e:{default:e}}var v={thumbnail:"",url:""},p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setOption(i),this.el=null,this.headerEl=null,this.bodyEl=null,this.footerEl=null,this.viewerWrapperEl=null,this.animationEl=null,this.animationImgEl=null,this.currentNumberEl=null,this.totalNumberEl=null,this.images=t,this.imagesLength=t.length,this.viewers=[],this.scaleStart=1,this.isScale=!1,this.isMove=!1,this.width=0,this.height=0,this.itemList=[],this.translateX=0,this.touch=null,this.event=new l.default(!1),this.isOpen=!1}return n(e,[{key:"_create",value:function(){this.el=(0,s.query)(".image-viewer")[0],this.destroy();var e=document.createElement("div");e.innerHTML=d.default,this.el=e.firstElementChild,(0,s.query)(this.container)[0].appendChild(this.el),this.bgEl=(0,s.query)(".image-viewer-bg",this.el)[0],this.headerEl=(0,s.query)(".image-header",this.el)[0],this.bodyEl=(0,s.query)(".image-body",this.el)[0],this.footerEl=(0,s.query)(".image-footer",this.el)[0],this.viewerWrapperEl=(0,s.query)(".image-body .viewer-wrapper",this.el)[0],this.animationEl=(0,s.query)(".image-animation",this.el)[0],this.animationImgEl=this.animationEl.children[0],this.itemList=this.viewerWrapperEl.children,this.width=this.el.clientWidth,this.height=this.el.clientHeight,this.opt.headerRender&&(this.headerEl.innerHTML=this.opt.headerRender()),this.opt.footerRender&&(this.footerEl.innerHTML=this.opt.footerRender()),this.currentNumberEl=(0,s.query)(".number-current",this.el)[0],this.totalNumberEl=(0,s.query)(".number-total",this.el)[0],this._initDuration()}},{key:"_init",value:function(){var e=this;this.viewers=[];for(var t,i=0,n=this.itemList.length;i<n;i++)t=this.itemList[i],this.viewers.push(new u.default(this,t,i));h.default.createLock(r.LOCK_NAME),this.animationImgEl.addEventListener("load",function(){e.event.emit(r.LOAD_IMG_COMPLETE)},!1),this.animationImgEl.addEventListener("error",function(){e.event.emit(r.LOAD_IMG_FAIL)},!1)}},{key:"_updateCountElement",value:function(){this.currentNumberEl&&(this.currentNumberEl.innerText=this.currentIndex+1),this.totalNumberEl&&(this.totalNumberEl.innerText=this.imagesLength)}},{key:"_bindEvent",value:function(){var e=this,t=new c.default(this.bodyEl,{enableScale:this.enableScale});t.on("tap",function(){return e._dealTap()}),t.on("panstart",function(t){return e._dealPanAction(t,"panstart")}),t.on("panmove",function(t){return e._dealPanAction(t,"panmove")}),t.on("panend",function(t){return e._dealPanAction(t,"panend")}),this.enableScale&&(t.on("pinchstart",function(t){return e._dealScaleAction(t,"pinchstart")}),t.on("pinch",function(t){return e._dealScaleAction(t,"pinch")}),t.on("pinchend",function(t){return e._dealScaleAction(t,"pinchend")})),this.touch=t}},{key:"_dealTap",value:function(){this._getCurrentViewer().isScale()?this.reset():this.opt.enableTapClose&&this.close()}},{key:"_dealPanAction",value:function(e,t){if(!this.isScale)switch(t){case"panstart":this._dealWithMoveActionStart(e);break;case"panmove":this._dealWithMoveAction(e);break;case"panend":this._dealWithMoveActionEnd(e)}}},{key:"_dealScaleAction",value:function(e,t){if(!this.isMove)switch(t){case"pinchstart":this._dealWithScaleActionStart(e);break;case"pinch":this._dealWithScaleAction(e);break;case"pinchend":this._dealWithScaleActionEnd(e)}}},{key:"_dealWithMoveActionStart",value:function(e){this.isMove=!0,h.default.getLockState(r.LOCK_NAME)?this._getCurrentViewer()._translatePanelStart(e):(this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),this.opt.beforeSwipe&&this.opt.beforeSwipe(this.currentIndex))}},{key:"_dealWithMoveAction",value:function(e,t){h.default.getLockState(r.LOCK_NAME)&&!t?this._getCurrentViewer()._translatePanel(e):(t&&this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX+e.deltaX,0))}},{key:"_dealWithMoveActionEnd",value:function(e,t){var i=this,n=!1;if(h.default.getLockState(r.LOCK_NAME)&&!t)this._getCurrentViewer()._translatePanelEnd(e);else{var a=e.deltaX,o=!1;0===this.currentIndex&&a>0&&this.opt.swipeFirstRight?o=this.opt.swipeFirstRight(this,Math.abs(a)):this.currentIndex===this.imagesLength-1&&a<0&&this.opt.swipeLastLeft&&(o=this.opt.swipeLastLeft(this,Math.abs(a))),o||(0!==a&&this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),0!==a&&this._checkDistance(a)?(this.viewers.forEach(function(e){return e.removeAnimation()}),n=a>0?this.swipeToPrev():this.swipeToNext()):(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),this.opt.afterSwipe&&this.opt.afterSwipe(this.currentIndex))}return setTimeout(function(){i.isMove=!1},0),n}},{key:"_dealWithScaleActionStart",value:function(e){this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),this.isScale=!0,this.scaleStart=e.scale,this._getCurrentViewer()._pinchStart()}},{key:"_dealWithScaleAction",value:function(e){this._getCurrentViewer()._pinch(e.scale-this.scaleStart)}},{key:"_dealWithScaleActionEnd",value:function(){var e=this;this._getCurrentViewer()._pinchEnd(),setTimeout(function(){e.isScale=!1},0)}},{key:"_getCurrentViewer",value:function(){return this.viewers[1]}},{key:"_checkDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.abs(e)>this.width/5}},{key:"_getPrevImage",value:function(){var e=this.currentIndex;return this.opt.loop&&this.imagesLength>2&&(e=0===this.currentIndex?this.imagesLength:this.currentIndex),this.images[e-1]||v}},{key:"_getCurrentImage",value:function(){return this.images[this.currentIndex]||v}},{key:"_getNextImage",value:function(){var e=this.currentIndex;return this.opt.loop&&this.imagesLength>2&&(e=this.currentIndex===this.imagesLength-1?-1:this.currentIndex),this.images[e+1]||v}},{key:"_getSpecificImage",value:function(e){return this.images[e]||v}},{key:"_getPositionAndSize",value:function(e){if((0,o.isPlainObject)(e))return{top:e.top||0,left:e.left||0,width:e.width||1,height:e.height||1};if(e&&e.getBoundingClientRect){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}return{top:0,left:0,width:0,height:0}}},{key:"_initDuration",value:function(){if(this.opt.hasOwnProperty("duration")){var e=this.opt.duration;this.bgEl.style.hasOwnProperty("transitionDuration")?this.animationEl.style.transitionDuration=this.bgEl.style.transitionDuration=e+"ms":this.bgEl.style.hasOwnProperty("webkitTransitionDuration")?this.animationEl.style.webkitTransitionDuration=this.bgEl.style.webkitTransitionDuration=e+"ms":(0,a.debug)("transition duration prop not found.")}}},{key:"_animation",value:function(e,t,i){var n=this,o=this.duration,l=this.animationEl.children[0],h=this._getCurrentViewer(),c=this._getPositionAndSize(1===t?this.opt.fadeInFn(this.currentIndex):h.panelEl),u=this._getPositionAndSize(1===t?h.panelEl:this.opt.fadeOutFn(this.currentIndex)),d=u.width/c.width;this.animationEl.style.width=c.width+"px",this.animationEl.style.height=c.height+"px",(0,s.setScaleAndTranslateStyle)(this.animationEl,1,c.left,c.top),l.src=e,this.event.once(r.LOAD_IMG_COMPLETE,function(){n.animationEl.classList.remove("hide"),setTimeout(function(){n.viewerWrapperEl.style.visibility="hidden",n.el.classList.add("animation"),n.bgEl.style.opacity=1===t?1:.001,(0,s.setScaleAndTranslateStyle)(n.animationEl,d,u.left,u.top),setTimeout(function(){n.el.classList.remove("animation"),n.animationEl.classList.add("hide"),n.event.off(r.LOAD_IMG_FAIL),l.src="",i()},o+20)},20)}),this.event.once(r.LOAD_IMG_FAIL,function(){(0,a.debug)("load animation image fail."),i()})}},{key:"_fadeIn",value:function(e){if(this.opt.fadeInFn){var t=this._getCurrentImage();this._animation(t.thumbnail||t.url,1,e)}else e()}},{key:"_fadeOut",value:function(e){if(this.opt.fadeOutFn){this.reset(!1);var t=this._getCurrentImage();this._animation(t.url,2,e)}else e()}},{key:"reset",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.viewers[1];t.isScale()&&(e?t.addAnimation():t.removeAnimation(),t._initImage(!0),setTimeout(function(){h.default.releaseLock(r.LOCK_NAME)},0))}},{key:"loopViewers",value:function(e){var t=null;return 0===e?(t=this.viewers.shift(),this.viewers.push(t)):1===e&&(t=this.viewers.pop(),this.viewers=[t].concat(this.viewers)),t}},{key:"swipeToPrev",value:function(){if(this.isOpen){if(this._getPrevImage().url){this.currentIndex--,this.translateX+=this.width,this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0);var e=this._getSpecificImage(this.currentIndex-1);if(e.url||0===this.currentIndex){var t=this.loopViewers(1);t.init(e,t.displayIndex-3,!0),this._getCurrentViewer().init(),this._updateCountElement()}return!0}return(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),!1}}},{key:"swipeToNext",value:function(){if(this.isOpen){if(this._getNextImage().url){this.currentIndex++,this.translateX-=this.width,this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0);var e=this._getSpecificImage(this.currentIndex+1);if(e.url||this.currentIndex===this.imagesLength-1){var t=this.loopViewers(0);t.init(e,t.displayIndex+3,!0),this._getCurrentViewer().init(),this._updateCountElement()}return!0}return(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),!1}}},{key:"swipeInByIndex",value:function(e,t,i){this.isOpen&&((0,o.isNumber)(e)&&e>-1&&e<this.imagesLength?(this.currentIndex=e,this.translateX=0,(0,s.setTranslateStyle)(this.viewerWrapperEl,0,0),this.viewers=this.viewers.sort(function(e,t){return e.index-t.index}),this.viewers[0].init(this._getPrevImage(),r.LEFT_IMG,!0),this.viewers[1].init(this._getCurrentImage(),r.CENTER_IMG,!0,t,i),this.viewers[2].init(this._getNextImage(),r.RIGHT_IMG,!0),this._updateCountElement()):(0,a.debug)("illegal index!"))}},{key:"open",value:function(e){var t=this;this.currentIndex=(0,o.isNumber)(e)?e:this.currentIndex,this.el||(this._create(),this._init(),this._bindEvent()),this.opt.fadeInFn&&(this.bgEl.style.opacity=.001,this.viewerWrapperEl.style.visibility="hidden"),this.el.style.display="block",this.isOpen=!0,this.swipeInByIndex(this.currentIndex,!1,function(){t._getCurrentViewer().removeAnimation(),t._fadeIn(function(){t.bgEl.style.opacity=1,t.viewerWrapperEl.style.visibility="visible",t._getCurrentImage().thumbnail&&t._getCurrentViewer().init(t._getCurrentImage(),r.CENTER_IMG,!0,1)})})}},{key:"setImageOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.length||(0,a.debug)("images array can not be empty!"),this.images=e,this.imagesLength=e.length,this.currentIndex=t,this.swipeInByIndex(this.currentIndex)}},{key:"setOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.opt=e,this.duration=e.duration||333,this.container=e.container||"body",this.enableScale=!!e.enableScale,this.autoLoadImage=!e.hasOwnProperty("autoLoadImage")||!!e.autoLoadImage,this.isOpen||(this.currentIndex=e.startIndex||this.currentIndex||0)}},{key:"destroy",value:function(){this.isOpen=!1,this.el&&(0,s.removeElement)(this.el)}},{key:"close",value:function(){var e=this;this.el&&(this.isOpen=!1,this._fadeOut(function(){e.animationEl.children[0].src="",e._getCurrentViewer().clearImg(),e.el.style.display="none"}))}}]),e}();t.default=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i(15));a(i(9));function a(e){return e&&e.__esModule?e:{default:e}}n.default.version="2.3.0",t.default=n.default}]).default});