!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ImageViewer=e():t.ImageViewer=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=16)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var a=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._enableMultiple=e,this._handlers={}}return n(t,[{key:"on",value:function(t,e,i){(i=void 0===i?this._enableMultiple:i)?(this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)):this._handlers[t]=[e]}},{key:"off",value:function(t){delete this._handlers[t]}},{key:"emit",value:function(t){for(var e=this,i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];var s=this._handlers[t]||[];s.length&&s.forEach(function(t){t.apply(e,n)})}}]),t}();e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._locks={}}return n(t,[{key:"createLock",value:function(t){this._locks[t]=!1}},{key:"deleteLock",value:function(t){delete this._locks[t]}},{key:"getLock",value:function(t){this._locks[t]=!0}},{key:"releaseLock",value:function(t){this._locks[t]=!1}},{key:"getLockState",value:function(t){return this._locks[t]}}]),t}();e.default=new a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.isNumber=function(t){return parseFloat(t)===t},e.isPlainObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.LOCK_NAME="STOP_SWIPE",e.ITEM_ANIMATION_CLASS="viewer-animation",e.LEFT_IMG=-1,e.CENTER_IMG=0,e.RIGHT_IMG=1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,a,s=(n=document.createElement("div").style,a="",["transform","webkitTransform","MozTransform","oTransform","msTransform"].forEach(function(t){void 0!==n[t]&&(a=t)}),a);e.query=function(t,e){return(e=e||document).querySelectorAll(t)},e.removeElement=function(t){var e=t.parentNode;e&&e.removeChild(t)},e.setTranslateStyle=function(t,e,i){t.style[s]="translate3d("+e+"px,"+i+"px,0)"},e.setScaleAndTranslateStyle=function(t,e,i,n){t.style[s]="scale3d("+e+","+e+",1) translate3d("+i+"px,"+n+"px,0)"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var a,s=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?t:(a=0===s.indexOf("//")?s:0===s.indexOf("/")?i+s:n+s.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")})}},function(t,e,i){var n,a,s={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=n.apply(this,arguments)),a}),o=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),l=null,h=0,c=[],u=i(5);function d(t,e){for(var i=0;i<t.length;i++){var n=t[i],a=s[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(w(n.parts[r],e))}else{var o=[];for(r=0;r<n.parts.length;r++)o.push(w(n.parts[r],e));s[n.id]={id:n.id,refs:1,parts:o}}}}function f(t,e){for(var i=[],n={},a=0;a<t.length;a++){var s=t[a],r=e.base?s[0]+e.base:s[0],o={css:s[1],media:s[2],sourceMap:s[3]};n[r]?n[r].parts.push(o):i.push(n[r]={id:r,parts:[o]})}return i}function v(t,e){var i=o(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),c.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=o(t.insertInto+" "+t.insertAt.before);i.insertBefore(e,a)}}function p(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function m(t){var e=document.createElement("style");return void 0===t.attrs.type&&(t.attrs.type="text/css"),g(e,t.attrs),v(t,e),e}function g(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function w(t,e){var i,n,a,s;if(e.transform&&t.css){if(!(s=e.transform(t.css)))return function(){};t.css=s}if(e.singleton){var r=h++;i=l||(l=m(e)),n=b.bind(null,i,r,!1),a=b.bind(null,i,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",g(e,t.attrs),v(t,e),e}(e),n=function(t,e,i){var n=i.css,a=i.sourceMap,s=void 0===e.convertToAbsoluteUrls&&a;(e.convertToAbsoluteUrls||s)&&(n=u(n));a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var r=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}.bind(null,i,e),a=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=m(e),n=function(t,e){var i=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),a=function(){p(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else a()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=r()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=f(t,e);return d(i,e),function(t){for(var n=[],a=0;a<i.length;a++){var r=i[a];(o=s[r.id]).refs--,n.push(o)}t&&d(f(t,e),e);for(a=0;a<n.length;a++){var o;if(0===(o=n[a]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete s[o.id]}}}};var y,_=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function b(t,e,i,n){var a=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=_(e,a);else{var s=document.createTextNode(a),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(s,r[e]):t.appendChild(s)}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var a=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),s=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[i].concat(s).concat([a]).join("\n")}var r;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},a=0;a<this.length;a++){var s=this[a][0];"number"==typeof s&&(n[s]=!0)}for(a=0;a<t.length;a++){var r=t[a];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),e.push(r))}},e}},function(t,e,i){(t.exports=i(7)(!1)).push([t.i,".image-viewer{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:100;font-size:0;overflow:hidden}.image-viewer .viewer-animation{transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.image-viewer .viewer{display:inline-block;position:absolute;top:50%;width:100%;text-align:center;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.image-viewer .image-header{position:absolute;top:0;left:0;width:100%;color:#fff;font-size:12px;z-index:12}.image-viewer .image-body{width:100%;height:100%;font-size:0;z-index:10}.image-viewer .image-body .viewer-wrapper{height:100%}.image-viewer .image-body .panel{display:inline-block;overflow:hidden}.image-viewer .image-body .panel img{max-width:100%;max-height:100%}.image-viewer .image-body .panel span{font-size:12px;color:#fff}.image-viewer .image-footer{position:absolute;left:0;bottom:0;width:100%;color:#fff;font-size:12px;z-index:12}.image-viewer .image-animation{position:absolute;z-index:5;will-change:transform,width,height}.image-viewer .image-animation img{max-width:100%;max-height:100%}.image-viewer .image-animation.hide{width:0!important;height:0!important;will-change:auto}.image-viewer .ball-clip-rotate{position:absolute;top:50%;left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:100%;z-index:11;text-align:center}.image-viewer .ball-clip-rotate>div{display:inline-block;width:26px;height:26px;border-radius:100%;border:2px solid #fff;border-bottom-color:transparent;background:0 0;-webkit-animation:ballRotate .75s 0s linear infinite;animation:ballRotate .75s 0s linear infinite}.image-viewer .ball-clip-rotate.hide{display:none}@-webkit-keyframes ballRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes ballRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},function(t,e,i){var n=i(8);"string"==typeof n&&(n=[[t.i,n,""]]);var a={sourceMap:!1,hmr:!0,transform:void 0,insertInto:void 0};i(6)(n,a);n.locals&&(t.exports=n.locals)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(4),s=i(3),r=h(i(1)),o=h(i(0)),l=i(2);function h(t){return t&&t.__esModule?t:{default:t}}var c=0,u=function(){},d=function(){function t(e,i,n,s,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=++c,this.src="",this.event=new o.default(!1),this.imageViewer=e,this.el=i,this.panelEl=i.firstElementChild,this.imageEl=(0,a.query)("img",this.el)[0],this.tipsEl=(0,a.query)("span",this.el)[0],this.imageOption=null,this.index=r,this.displayIndex=0,this.width=n,this.height=s,this.realWidth=0,this.realHeight=0,this.translateX=0,this.translateY=0,this.scale=1,this.currentScale=1,this.translatePanelX=0,this.translatePanelY=0,this.currentPanelX=0,this.currentPanelY=0,this.allowDistanceX=0,this.allowDistanceY=0,this.needResetX=!1,this.needResetY=!1,this.SUCCESS_EVENT="LOAD_COMPLETE",this.FAIL_EVENT="LOAD_FAIL",this._bindEvent()}return n(t,[{key:"_initImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;t&&(this.scale=1,this.allowDistanceX=this.allowDistanceY=0),this.translatePanelX=0,this.translatePanelY=0,this.currentPanelX=0,this.currentPanelY=0,this.realWidth=this.panelEl.clientWidth*this.scale,this.realHeight=this.panelEl.clientHeight*this.scale,this.translateX=this.displayIndex*this.width,this.translateY=-this.el.clientHeight/2,this.needResetX=this.needResetY=!1,(0,a.setScaleAndTranslateStyle)(this.panelEl,this.scale,this.translatePanelX,this.translatePanelY),(0,a.setTranslateStyle)(this.el,this.translateX,this.translateY),e()}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.imageOption,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.displayIndex,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments[4],o="",l=function(t){(n.src===o||t)&&(n.imageEl.style.display="",n.tipsEl.innerText="",n._initImage(i,r))},h=function(t){(n.src===o||t)&&(n.imageEl.style.display="none",o&&(n.tipsEl.innerText="图片加载失败"))};this.imageOption=t,this.displayIndex=e,s&&this.src!==this.imageOption.url?t._hasLoadLarge?o=t.url:(o=t.thumbnail)?this.isActive()&&(this.imageViewer.showLoading(),window.requestAnimationFrame(function(){n.loadImg(t.url,function(){n.src===t.thumbnail&&n.isActive()&&(n.imageViewer.hideLoading(),n._setImageUrl(t.url),l(!0)),t._hasLoadLarge=!0},function(){n.src===t.thumbnail&&n.isActive()&&(n.imageViewer.hideLoading(),h(!0)),t._hasLoadLarge=!0})})):(o=t.url,this.imageEl.style.display="none"):o=t.thumbnail||t.url,this._setImageUrl(o),this.event.on(this.SUCCESS_EVENT,l),this.event.on(this.FAIL_EVENT,h),(0,a.setTranslateStyle)(this.el,this.displayIndex*this.width,this.translateY)}},{key:"_setImageUrl",value:function(t){this.imageEl.src=this.src=t}},{key:"loadImg",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments[1],i=arguments[2],n=new Image;n.onload=function(){return e()},n.onerror=function(){return i()},n.src=t}},{key:"isActive",value:function(){return this.imageViewer._getCurrentViewer().id===this.id}},{key:"_bindEvent",value:function(){var t=this;this.imageEl.addEventListener("load",function(){t.event.emit(t.SUCCESS_EVENT)},!1),this.imageEl.addEventListener("error",function(){t.event.emit(t.FAIL_EVENT)},!1)}},{key:"_pinchStart",value:function(){this.removeAnimation(),this.panelEl.style.willChange="transform"}},{key:"_pinch",value:function(t){var e=t*this.scale+this.scale;e>.5&&e<8&&(this.currentScale=e,(0,a.setScaleAndTranslateStyle)(this.panelEl,this.currentScale,this.translatePanelX,this.translatePanelY))}},{key:"_pinchEnd",value:function(t){var e=this;this.scale=(0,l.isNumber)(t)?t:this.currentScale,this.realWidth=this.panelEl.clientWidth*this.scale,this.realHeight=this.panelEl.clientHeight*this.scale,this.allowDistanceX=(this.realWidth-this.width)/2/this.scale+2,this.allowDistanceY=(this.realHeight-this.height)/2/this.scale+2,(this.realWidth<this.width||this.realHeight<this.height)&&(this.addAnimation(),this._initImage(!1)),window.requestAnimationFrame(function(){e.isScale()?r.default.getLock(s.LOCK_NAME):r.default.releaseLock(s.LOCK_NAME),e.panelEl.style.willChange="auto"})}},{key:"_calculate",value:function(t,e){return t>0?t-e:t+e}},{key:"_translatePanelStart",value:function(){this.removeAnimation()}},{key:"_translatePanel",value:function(t){var e=0,i=t.deltaX,n=t.deltaY;this.realWidth<=this.width&&i?this.imageViewer._dealWithMoveAction({deltaX:i},!0):(this.allowDistanceX>0&&i&&(this.currentPanelX=i/this.scale+this.translatePanelX,this.needResetX=!(-this.allowDistanceX<this.currentPanelX&&this.currentPanelX<this.allowDistanceX)),this.needResetX?(this.imageViewer._dealWithMoveAction({deltaX:this._calculate(this.currentPanelX,this.allowDistanceX)},!0),e=this.currentPanelX>0?this.allowDistanceX:-this.allowDistanceX):(this.imageViewer._dealWithMoveAction({deltaX:0},!0),e=this.currentPanelX)),this.allowDistanceY>0&&n&&(this.currentPanelY=n/this.scale+this.translatePanelY,this.needResetY=!(-this.allowDistanceY<this.currentPanelY&&this.currentPanelY<this.allowDistanceY)),(0,a.setScaleAndTranslateStyle)(this.panelEl,this.scale,e,this.currentPanelY)}},{key:"_translatePanelEnd",value:function(t){var e=this,i=!1,n=t.deltaX;this.realWidth<=this.width&&n?i=this.imageViewer._dealWithMoveActionEnd({deltaX:n},!0):this.needResetX&&(i=this.imageViewer._dealWithMoveActionEnd({deltaX:this._calculate(this.currentPanelX,this.allowDistanceX)},!0)),i?(this._initImage(!0),window.requestAnimationFrame(function(){r.default.releaseLock(s.LOCK_NAME)})):(this.needResetX?this.translatePanelX=this.currentPanelX>0?this.allowDistanceX:-this.allowDistanceX:this.translatePanelX=this.currentPanelX,this.needResetY?this.translatePanelY=this.currentPanelY>0?this.allowDistanceY:-this.allowDistanceY:this.translatePanelY=this.currentPanelY,(this.needResetX||this.needResetY)&&window.requestAnimationFrame(function(){e.addAnimation(),(0,a.setScaleAndTranslateStyle)(e.panelEl,e.scale,e.translatePanelX,e.translatePanelY)}),this.needResetX=this.needResetY=!1)}},{key:"isScale",value:function(){return Math.abs(this.scale-1)>.001}},{key:"addAnimation",value:function(){this.panelEl.classList.add(s.ITEM_ANIMATION_CLASS),this.el.classList.add(s.ITEM_ANIMATION_CLASS)}},{key:"removeAnimation",value:function(){this.panelEl.classList.remove(s.ITEM_ANIMATION_CLASS),this.el.classList.remove(s.ITEM_ANIMATION_CLASS)}},{key:"clearImg",value:function(){this.src="",this.imageEl.src="",this.imageOption=null}}]),t}();e.default=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test-passive",null,a)}catch(t){}e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=r(i(0)),s=r(i(11));function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=0,h=function(){function t(e,i,n){o(this,t),this.time=(new Date).getTime(),this.srcEvent=e,this.prevEvent=i,this.touch=n,this.type=[],this.valid=!1,this.threshold=4,this.preventDefault(),this.stopPropagation(),this._getTouches(),this._initDelta(),this._initScale(),this._initTap()}return n(t,[{key:"_getTouches",value:function(){var t=this.srcEvent.touches.length?this.srcEvent.touches:this.srcEvent.changedTouches;this.touches=Array.prototype.slice.call(t,0)}},{key:"_initDelta",value:function(){var t=this.touches[0].clientX,e=this.touches[0].clientY;this.prevEvent?(t-=this.prevEvent.touches[0].clientX,e-=this.prevEvent.touches[0].clientY):t=e=0,this.deltaX=t,this.deltaY=e,(Math.abs(t)>this.threshold||Math.abs(e)>this.threshold)&&(this.type.push("pan"),this.valid=!0)}},{key:"_initScale",value:function(){var t=1;if(this.touch.enableScale&&this.prevEvent&&this.prevEvent.touches.length>1&&this.touches.length>1){var e=Math.abs(this.touches[0].clientX-this.touches[1].clientX),i=Math.abs(this.touches[0].clientY-this.touches[1].clientY),n=Math.abs(this.prevEvent.touches[0].clientX-this.prevEvent.touches[1].clientX),a=Math.abs(this.prevEvent.touches[0].clientY-this.prevEvent.touches[1].clientY);t=Math.sqrt(e*e+i*i)/Math.sqrt(n*n+a*a),this.type.push("pinch")}this.scale=t}},{key:"_initTap",value:function(){var t=this.touch._startEvent;t&&1===t.touches.length&&"touchstart"===this.srcEvent.type&&1===this.touches.length&&(this.time-t.time<250&&Math.abs(this.touches[0].clientX-t.touches[0].clientX)<30&&Math.abs(this.touches[0].clientY-t.touches[0].clientY)<30&&(this.type=["doubleTap"],this.valid=!0))}},{key:"stopPropagation",value:function(){this.srcEvent.stopPropagation&&this.srcEvent.stopPropagation()}},{key:"preventDefault",value:function(){this.srcEvent.preventDefault&&this.srcEvent.preventDefault()}}]),t}(),c=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),e&&(this.id=++l,this.el=e,this.enableScale=!!i.enableScale,this.hasTriggerStart=!1,this._startEvent=null,this._prevEvent=null,this.tapTimeoutId=null,this.isTapStart=!1,this._commonEvent=new a.default,this._bindEvent())}return n(t,[{key:"_cancelTap",value:function(){this.tapTimeoutId&&(clearTimeout(this.tapTimeoutId),this.isTapStart=!1)}},{key:"_bindEvent",value:function(){var t=!!s.default&&{passive:!1};this.el.addEventListener("touchstart",this,t),this.el.addEventListener("touchmove",this,t),this.el.addEventListener("touchend",this,t),this.el.addEventListener("touchcancel",this,t)}},{key:"_start",value:function(t){var e=this;this._startEvent=new h(t,null,this),this._startEvent.touches.length>1?this._cancelTap():(this.isTapStart=!0,this.tapTimeoutId=setTimeout(function(){e._cancelTap()},300))}},{key:"_move",value:function(t){if(this._startEvent){var e=new h(t,this._startEvent,this);e.valid&&(this.hasTriggerStart||(this.hasTriggerStart=!0,e.type.includes("pinch")&&this._commonEvent.emit("pinchstart",this._startEvent),e.type.includes("pan")&&this._commonEvent.emit("panstart",this._startEvent)),e.type.includes("pinch")&&this._commonEvent.emit("pinch",e),e.type.includes("pan")&&this._commonEvent.emit("panmove",e),this._prevEvent=e)}}},{key:"_end",value:function(t){if(this._startEvent){var e=new h(t,this._startEvent,this);this.isTapStart&&0===e.type.length&&(this._cancelTap(),e.type=["type"],this._commonEvent.emit("tap",e)),e.valid&&(this._prevEvent&&(this._prevEvent.type.includes("pinch")&&this._commonEvent.emit("pinchend",e),e.type.includes("pan")&&this._commonEvent.emit("panend",e),this.hasTriggerStart=!1),this._startEvent=null),this._startEvent&&this._startEvent.type.includes("doubleTap")&&this._commonEvent.emit("doubleTap",e)}}},{key:"_cancel",value:function(){this._startEvent=null,this.hasTriggerStart=!1}},{key:"handleEvent",value:function(t){switch(t.type){case"touchstart":this._start(t);break;case"touchmove":this._move(t);break;case"touchend":this._end(t);break;case"touchcancel":this._cancel(t)}}},{key:"on",value:function(t,e){this._commonEvent.on(t,e)}}]),t}();e.default=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.debug=function(t){window.console.log("[ImageViewer]:"+t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(13),s=i(4),r=i(3),o=i(2),l=u(i(1)),h=u(i(12)),c=u(i(10));function u(t){return t&&t.__esModule?t:{default:t}}var d={thumbnail:"",url:""},f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opt=i,this.duration=this.opt.duration||10,this.el=null,this.headerEl=null,this.bodyEl=null,this.footerEl=null,this.viewerWrapperEl=null,this.animationEl=null,this.currentNumberEl=null,this.totalNumberEl=null,this.loadingEl=null,this.images=e,this.imagesLength=e.length,this.container=i.container||"body",this.enableScale=!!i.enableScale,this.currentIndex=i.startIndex||0,this.viewers=[],this.scaleStart=1,this.isScale=!1,this.isMove=!1,this.width=0,this.height=0,this.itemList=[],this.translateX=0,this.touch=null}return n(t,[{key:"_create",value:function(){this.el=(0,s.query)(".image-viewer")[0],this.destroy();var t=document.createElement("div");t.innerHTML='<div class="image-viewer">\n                <div class="image-header"></div>\n                <div class="image-body">\n                    <div class="viewer-wrapper">\n                        <div class="viewer"><div class="panel"><img><span></span></div></div>\n                        <div class="viewer"><div class="panel"><img><span></span></div></div>\n                        <div class="viewer"><div class="panel"><img><span></span></div></div>     \n                    </div>\n                </div>\n                <div class="image-footer"></div>\n                <div class="image-animation hide"><img></div> \n                <div class="ball-clip-rotate hide"><div></div></div>\n            </div>',this.el=t.firstElementChild,(0,s.query)(this.container)[0].appendChild(this.el),this.headerEl=(0,s.query)(".image-header",this.el)[0],this.bodyEl=(0,s.query)(".image-body",this.el)[0],this.footerEl=(0,s.query)(".image-footer",this.el)[0],this.viewerWrapperEl=(0,s.query)(".image-body .viewer-wrapper",this.el)[0],this.animationEl=(0,s.query)(".image-animation",this.el)[0],this.loadingEl=(0,s.query)(".ball-clip-rotate",this.el)[0],this.itemList=this.viewerWrapperEl.children,this.width=this.el.clientWidth,this.height=this.el.clientHeight,this.opt.headerRender&&(this.headerEl.innerHTML=this.opt.headerRender()),this.opt.footerRender&&(this.footerEl.innerHTML=this.opt.footerRender()),this.currentNumberEl=(0,s.query)(".number-current",this.el)[0],this.totalNumberEl=(0,s.query)(".number-total",this.el)[0]}},{key:"_init",value:function(){this.viewers=[];for(var t,e=0,i=this.itemList.length;e<i;e++)t=this.itemList[e],this.viewers.push(new c.default(this,t,this.width,this.height,e));l.default.createLock(r.LOCK_NAME)}},{key:"_updateCountElement",value:function(){this.currentNumberEl&&(this.currentNumberEl.innerText=this.currentIndex+1),this.totalNumberEl&&(this.totalNumberEl.innerText=this.imagesLength)}},{key:"_bindEvent",value:function(){var t=this,e=new h.default(this.bodyEl,{enableScale:this.enableScale});e.on("tap",function(){return t._dealTap()}),e.on("panstart",function(e){return t._dealPanAction(e,"panstart")}),e.on("panmove",function(e){return t._dealPanAction(e,"panmove")}),e.on("panend",function(e){return t._dealPanAction(e,"panend")}),this.enableScale&&(e.on("pinchstart",function(e){return t._dealScaleAction(e,"pinchstart")}),e.on("pinch",function(e){return t._dealScaleAction(e,"pinch")}),e.on("pinchend",function(e){return t._dealScaleAction(e,"pinchend")})),this.touch=e}},{key:"_dealTap",value:function(){this._getCurrentViewer().isScale()?this.reset():this.opt.enableTapClose&&this.close()}},{key:"_dealPanAction",value:function(t,e){if(!this.isScale)switch(e){case"panstart":this._dealWithMoveActionStart(t);break;case"panmove":this._dealWithMoveAction(t);break;case"panend":this._dealWithMoveActionEnd(t)}}},{key:"_dealScaleAction",value:function(t,e){if(!this.isMove)switch(e){case"pinchstart":this._dealWithScaleActionStart(t);break;case"pinch":this._dealWithScaleAction(t);break;case"pinchend":this._dealWithScaleActionEnd(t)}}},{key:"_dealWithMoveActionStart",value:function(t){this.isMove=!0,l.default.getLockState(r.LOCK_NAME)?this._getCurrentViewer()._translatePanelStart(t):(this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),this.opt.beforeSwipe&&this.opt.beforeSwipe(this.currentIndex),this.viewerWrapperEl.style.willChange="transform")}},{key:"_dealWithMoveAction",value:function(t,e){l.default.getLockState(r.LOCK_NAME)&&!e?this._getCurrentViewer()._translatePanel(t):(e&&this.viewerWrapperEl.classList.remove(r.ITEM_ANIMATION_CLASS),(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX+t.deltaX,0))}},{key:"_dealWithMoveActionEnd",value:function(t,e){var i=this,n=!1;if(l.default.getLockState(r.LOCK_NAME)&&!e)this._getCurrentViewer()._translatePanelEnd(t);else{var a=t.deltaX,o=!1;0===this.currentIndex&&a>0&&this.opt.swipeFirstRight?o=this.opt.swipeFirstRight(this,Math.abs(a)):this.currentIndex===this.imagesLength-1&&a<0&&this.opt.swipeLastLeft&&(o=this.opt.swipeLastLeft(this,Math.abs(a))),o||(0!==a&&this.viewerWrapperEl.classList.add(r.ITEM_ANIMATION_CLASS),0!==a&&this._checkDistance(a)?(this.viewers.forEach(function(t){return t.removeAnimation()}),n=a>0?this.swipeToPrev():this.swipeToNext(),this._updateCountElement()):(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),this.opt.afterSwipe&&this.opt.afterSwipe(this.currentIndex)),this.viewerWrapperEl.style.willChange="auto"}return window.requestAnimationFrame(function(){i.isMove=!1}),n}},{key:"_dealWithScaleActionStart",value:function(t){this.isScale=!0,this.scaleStart=t.scale,this._getCurrentViewer()._pinchStart()}},{key:"_dealWithScaleAction",value:function(t){this._getCurrentViewer()._pinch(t.scale-this.scaleStart)}},{key:"_dealWithScaleActionEnd",value:function(){var t=this;this._getCurrentViewer()._pinchEnd(),window.requestAnimationFrame(function(){t.isScale=!1})}},{key:"_getCurrentViewer",value:function(){return this.viewers[1]}},{key:"_checkDistance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.abs(t)>this.width/5}},{key:"_getPrevImage",value:function(){var t=this.currentIndex;return this.opt.loop&&this.imagesLength>2&&(t=0===this.currentIndex?this.imagesLength:this.currentIndex),this.images[t-1]||d}},{key:"_getCurrentImage",value:function(){return this.images[this.currentIndex]||d}},{key:"_getNextImage",value:function(){var t=this.currentIndex;return this.opt.loop&&this.imagesLength>2&&(t=this.currentIndex===this.imagesLength-1?-1:this.currentIndex),this.images[t+1]||d}},{key:"_getSpecificImage",value:function(t){return this.images[t]||d}},{key:"_getPositionAndSize",value:function(t){if((0,o.isPlainObject)(t))return{top:t.top||0,left:t.left||0,width:t.width||0,height:t.height||0};if(t.getBoundingClientRect){var e=t.getBoundingClientRect();return{top:e.top,left:e.left,width:e.width,height:e.height}}return{top:0,left:0,width:0,height:0}}},{key:"_fadeIn",value:function(t){var e=this;if(this.opt.fadeInFn){var i=this._getCurrentImage(),n=this.duration,a=this._getPositionAndSize(this.opt.fadeInFn(this.currentIndex)),r=this.animationEl.style;r.top=a.top+"px",r.left=a.left+"px",r.width=a.width+"px",r.height=a.height+"px";var o=this._getCurrentViewer(),l=this._getPositionAndSize(o.el),h=(l.top-a.top)/n,c=(l.left-a.left)/n,u=(l.width-a.width)/n,d=(l.height-a.height)/n,f=1/n,v=0,p=0,m=0,g=!0;this.animationEl.children[0].src=i.thumbnail||i.url,this.animationEl.classList.remove("hide"),function i(){g?(g=!1,Math.abs(l.top-a.top-p)>=.5&&(p+=h,g=!0),Math.abs(l.left-a.left-m)>=.5&&(m+=c,g=!0),Math.abs(l.width-a.width)>=.5&&(a.width+=u,r.width=a.width+"px",g=!0),Math.abs(l.height-a.height)>=.5&&(a.height+=d,r.height=a.height+"px",g=!0),v<1&&(v+=f,e.el.style.opacity=v,g=!0),(0,s.setTranslateStyle)(e.animationEl,m.toFixed(4),p.toFixed(4)),window.requestAnimationFrame(i)):window.requestAnimationFrame(function(){e.animationEl.classList.add("hide"),t()})}()}else t()}},{key:"_fadeOut",value:function(t){var e=this;if(this.opt.fadeOutFn){var i=this._getCurrentImage(),n=this.duration,a=this._getPositionAndSize(this.opt.fadeOutFn(this.currentIndex)),r=this.animationEl.style;r.top=a.top+"px",r.left=a.left+"px";var o=this._getCurrentViewer(),l=this._getPositionAndSize(o.el),h=l.top-a.top,c=l.left-a.left,u=l.width-a.width,d=l.height-a.height,f=h/n,v=c/n,p=u/n,m=d/n,g=1/n,w=1,y=l.width,_=l.height,b=!0;(0,s.setTranslateStyle)(this.animationEl,c,h),r.width=l.width+"px",r.height=l.height+"px";this.animationEl.children[0].src=i.url,this.animationEl.classList.remove("hide"),function i(){b?(b=!1,Math.abs(h)>.5&&(h-=f,b=!0),Math.abs(c)>.5&&(c-=v,b=!0),y>=a.width&&(y-=p,r.width=y+"px",b=!0),_>=a.height&&(_-=m,r.height=_+"px",b=!0),w>0&&(w-=g,e.el.style.opacity=w,b=!0),(0,s.setTranslateStyle)(e.animationEl,c.toFixed(4),h.toFixed(4)),window.requestAnimationFrame(i)):window.requestAnimationFrame(function(){e.animationEl.classList.add("hide"),t()})}()}else t()}},{key:"showLoading",value:function(){this.loadingEl.classList.remove("hide")}},{key:"hideLoading",value:function(){this.loadingEl.classList.add("hide")}},{key:"reset",value:function(){var t=this.viewers[1];t.addAnimation(),t._initImage(!0),window.requestAnimationFrame(function(){l.default.releaseLock(r.LOCK_NAME)})}},{key:"loopViewers",value:function(t){var e=null;return 0===t?(e=this.viewers.shift(),this.viewers.push(e)):1===t&&(e=this.viewers.pop(),this.viewers=[e].concat(this.viewers)),e}},{key:"swipeToPrev",value:function(){if(this._getPrevImage().url){this.currentIndex--,this.translateX+=this.width,(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0);var t=this._getSpecificImage(this.currentIndex-1);if(t.url||0===this.currentIndex){var e=this.loopViewers(1);e.init(t,e.displayIndex-3,!0),this._getCurrentViewer().init()}return!0}return(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),!1}},{key:"swipeToNext",value:function(){if(this._getNextImage().url){this.currentIndex++,this.translateX-=this.width,(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0);var t=this._getSpecificImage(this.currentIndex+1);if(t.url||this.currentIndex===this.imagesLength-1){var e=this.loopViewers(0);e.init(t,e.displayIndex+3,!0),this._getCurrentViewer().init()}return!0}return(0,s.setTranslateStyle)(this.viewerWrapperEl,this.translateX,0),!1}},{key:"swipeInByIndex",value:function(t,e,i){(0,o.isNumber)(t)&&t>-1&&t<this.imagesLength?(this.currentIndex=t,this.translateX=0,(0,s.setTranslateStyle)(this.viewerWrapperEl,0,0),this.viewers=this.viewers.sort(function(t,e){return t.index-e.index}),this.viewers[0].init(this._getPrevImage(),r.LEFT_IMG,!0),this.viewers[1].init(this._getCurrentImage(),r.CENTER_IMG,!0,e,i),this.viewers[2].init(this._getNextImage(),r.RIGHT_IMG,!0),this._updateCountElement()):(0,a.debug)("illegal index!")}},{key:"setImageOption",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.length||(0,a.debug)("images array can not be empty!"),this.images=t,this.imagesLength=t.length,this.currentIndex=e,this._init(),this.swipeInByIndex(this.currentIndex)}},{key:"destroy",value:function(){this.el&&(0,s.removeElement)(this.el)}},{key:"close",value:function(){var t=this;this.el&&(this.bodyEl.style.visibility="hidden",this._fadeOut(function(){t.el.style.display="none",t._getCurrentViewer().clearImg()}))}},{key:"open",value:function(t){var e=this;this.currentIndex=(0,o.isNumber)(t)?t:this.currentIndex,this.el||(this._create(),this._init(),this._bindEvent()),this.opt.fadeInFn&&(this.el.style.opacity=0,this.bodyEl.style.visibility="hidden"),this.el.style.display="block",this.swipeInByIndex(this.currentIndex,!1,function(){window.requestAnimationFrame(function(){e._fadeIn(function(){e.el.style.opacity=1,e.bodyEl.style.visibility="visible",e.swipeInByIndex(e.currentIndex)})})})}}]),t}();e.default=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){for(var t=0,e=["webkit","moz"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16.7-(i-t)),a=window.setTimeout(function(){e(i+n)},n);return t=i+n,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i(15)),a=s(i(14));s(i(9));function s(t){return t&&t.__esModule?t:{default:t}}(0,n.default)(),e.default=a.default}]).default});